// sQuery
@import 'zen.sketchplugin/Contents/Sketch/sQuery/sQuery.js';
@import 'zen.sketchplugin/Contents/Sketch/sQuery/plugins/core.move.js';
@import 'zen.sketchplugin/Contents/Sketch/sQuery/plugins/core.areFroups.js';
@import 'zen.sketchplugin/Contents/Sketch/sQuery/plugins/core.areShapes.js';

// sTrue
@import 'zen.sketchplugin/contents/sketch/sTrue/sTrue.js';

// Tests

sTrue("Basics", function() {
  // @Sketch
  // Tiene que existir al menos un artboard

  // @Setup

  // @Tests
  this.true($().typename == 'sQuery');
  this.equal($("%selected%").queryUsed(), "%selected%");
})

sTrue("Crear una capa tipo Shape", function() {

  // @Setup
  // Select first artboard
  var artboards = context.document.currentPage().artboards();
  artboards[0].setIsSelected(true);
  var newLayer = $('%artboard%').createShapeLayer("Froi");

  // @Tests
  this.class(newLayer, "MSShapeGroup", "La clase de newLayer tiene que ser MSShapeGroup");

  // @End
  $(newLayer).remove();
  newLayer = null;
  artboards[0].setIsSelected(true);

});


sTrue("Borra una capa", function() {

  // @Setup
  var artboards = context.document.currentPage().artboards();
  artboards[0].setIsSelected(true);
  var newLayer = $('%artboard%').createShapeLayer("Froi");
  $(newLayer).remove();

  // @Tests
  this.class(newLayer, "MSShapeGroup");

  // @End
  newLayer = null;
  artboards[0].setIsSelected(true);

});



sTrue("Agrupar capas", function() {

  // @Setup
  var artboards = context.document.currentPage().artboards();
  artboards[0].setIsSelected(true);
  var newLayer01 = $('%artboard%').createShapeLayer("Layer01");
  var newLayer02 = $('%artboard%').createShapeLayer("Layer02");
  var $selection = $("%shapes%");
  var groupName = "Froiland";
  var newGroup = $selection.group(groupName);

  // @Tests
  this.class(newGroup, "MSLayerGroup");
  this.equal(newGroup.layers().length(), 2)

  // @End
  $(newLayer01).remove();
  $(newLayer02).remove();
  newLayer01, newLayer02 = null;

  var artboards = context.document.currentPage().artboards();
  artboards[0].setIsSelected(true);

  // @Tests
  this.class(newGroup, "MSLayerGroup", "La clase de newGroup tiene que ser MSLayerGroup");
  this.equal(newGroup.name(), groupName, "El nombre de la capa debe ser " + groupName);
  this.true($selection.length > 0);

  // @End
  $selection, groupName, newGroup = null;

  var artboards = context.document.currentPage().artboards();
  artboards[0].setIsSelected(true);

});
